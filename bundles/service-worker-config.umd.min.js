/**
 * @license Angular v5.2.0-beta.0-057b357
 * (c) 2010-2017 Google, Inc. https://angular.io/
 * License: MIT
 */
!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory((global.ng=global.ng||{},global.ng.serviceWorker=global.ng.serviceWorker||{},global.ng.serviceWorker.config={}))}(this,function(exports){"use strict";function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})}function __generator(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=y[2&op[0]?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g}function parseDurationToMs(duration){for(var array,matches=[];null!==(array=PARSE_TO_PAIRS.exec(duration));)matches.push(array[0]);return matches.map(function(match){var res=PAIR_SPLIT.exec(match);if(null===res)throw new Error("Not a valid duration: "+match);var factor=0;switch(res[2]){case"d":factor=864e5;break;case"h":factor=36e5;break;case"m":factor=6e4;break;case"s":factor=1e3;break;case"u":factor=1;break;default:throw new Error("Not a valid duration unit: "+res[2])}return parseInt(res[1])*factor}).reduce(function(total,value){return total+value},0)}function globToRegex(glob){for(var segments=glob.split("/").reverse(),regex="";segments.length>0;){var segment=segments.pop();if("**"===segment)segments.length>0?regex+=WILD_OPEN:regex+=".*";else{regex+=TO_ESCAPE.reduce(function(segment,escape){return segment.replace(escape.replace,escape.with)},segment),segments.length>0&&(regex+="\\/")}}return regex}function globListToMatcher(globs){var patterns=globs.map(function(pattern){return pattern.startsWith("!")?{positive:!1,regex:new RegExp("^"+globToRegex(pattern.substr(1))+"$")}:{positive:!0,regex:new RegExp("^"+globToRegex(pattern)+"$")}});return function(file){return matches(file,patterns)}}function matches(file,patterns){return patterns.reduce(function(isMatch,pattern){return pattern.positive?isMatch||pattern.regex.test(file):isMatch&&!pattern.regex.test(file)},!1)}function joinUrls(a,b){return a.endsWith("/")&&b.startsWith("/")?a+b.substr(1):a.endsWith("/")||b.startsWith("/")?a+b:a+"/"+b}/**
 * @license Angular v5.2.0-beta.0-057b357
 * (c) 2010-2017 Google, Inc. https://angular.io/
 * License: MIT
 */
/**
 * @license
 * Copyright Google Inc. All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */
var PARSE_TO_PAIRS=/([0-9]+[^0-9]+)/g,PAIR_SPLIT=/^([0-9]+)([dhmsu]+)$/,WILD_OPEN="(?:.+\\/)?",TO_ESCAPE=[{replace:/\./g,with:"\\."},{replace:/\?/g,with:"\\?"},{replace:/\+/g,with:"\\+"},{replace:/\*/g,with:"[^\\/]+"}],Generator=function(){function Generator(fs,baseHref){this.fs=fs,this.baseHref=baseHref}return Generator.prototype.process=function(config){return __awaiter(this,void 0,void 0,function(){var hashTable,_a;return __generator(this,function(_b){switch(_b.label){case 0:return hashTable={},_a={configVersion:1,index:joinUrls(this.baseHref,config.index),appData:config.appData},[4,this.processAssetGroups(config,hashTable)];case 1:return[2,(_a.assetGroups=_b.sent(),_a.dataGroups=this.processDataGroups(config),_a.hashTable=hashTable,_a)]}})})},Generator.prototype.processAssetGroups=function(config,hashTable){return __awaiter(this,void 0,void 0,function(){var seenMap,_this=this;return __generator(this,function(_a){return seenMap=new Set,[2,Promise.all((config.assetGroups||[]).map(function(group){return __awaiter(_this,void 0,void 0,function(){var fileMatcher,versionedMatcher,allFiles,versionedFiles,plainFiles,patterns,_this=this;return __generator(this,function(_a){switch(_a.label){case 0:return fileMatcher=globListToMatcher(group.resources.files||[]),versionedMatcher=globListToMatcher(group.resources.versionedFiles||[]),[4,this.fs.list("/")];case 1:return allFiles=_a.sent(),versionedFiles=allFiles.filter(versionedMatcher).filter(function(file){return!seenMap.has(file)}),versionedFiles.forEach(function(file){return seenMap.add(file)}),plainFiles=allFiles.filter(fileMatcher).filter(function(file){return!seenMap.has(file)}),plainFiles.forEach(function(file){return seenMap.add(file)}),[4,versionedFiles.concat(plainFiles).reduce(function(previous,file){return __awaiter(_this,void 0,void 0,function(){var hash;return __generator(this,function(_a){switch(_a.label){case 0:return[4,previous];case 1:return _a.sent(),[4,this.fs.hash(file)];case 2:return hash=_a.sent(),hashTable[joinUrls(this.baseHref,file)]=hash,[2]}})})},Promise.resolve())];case 2:return _a.sent(),patterns=(group.resources.urls||[]).map(function(glob){return glob.startsWith("/")||-1!==glob.indexOf("://")?glob:joinUrls(_this.baseHref,glob)}).map(function(glob){return globToRegex(glob)}),[2,{name:group.name,installMode:group.installMode||"prefetch",updateMode:group.updateMode||group.installMode||"prefetch",urls:[].concat(plainFiles).concat(versionedFiles).map(function(url){return joinUrls(_this.baseHref,url)}),patterns:patterns}]}})})}))]})})},Generator.prototype.processDataGroups=function(config){var _this=this;return(config.dataGroups||[]).map(function(group){var patterns=group.urls.map(function(glob){return glob.startsWith("/")||-1!==glob.indexOf("://")?glob:joinUrls(_this.baseHref,glob)}).map(function(glob){return globToRegex(glob)});return{name:group.name,patterns:patterns,strategy:group.cacheConfig.strategy||"performance",maxSize:group.cacheConfig.maxSize,maxAge:parseDurationToMs(group.cacheConfig.maxAge),timeoutMs:group.cacheConfig.timeout&&parseDurationToMs(group.cacheConfig.timeout),version:void 0!==group.version?group.version:1}})},Generator}();exports.Generator=Generator,Object.defineProperty(exports,"__esModule",{value:!0})});
//# sourceMappingURL=/home/travis/build/angular/angular/dist/packages-dist/service-worker/bundles/service-worker-config.umd.min.js.map